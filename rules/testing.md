# テスト方針

## 本ファイルの方針

テストツールの詳細な使い方は、実装時に公式ドキュメントを参照すること：
- Vitest: https://vitest.dev
- React Testing Library: https://testing-library.com/docs/react-testing-library/intro
- Playwright: https://playwright.dev
- Next.js Testing Guide: https://nextjs.org/docs/app/guides/testing

本ファイルには、プロジェクト固有の方針のみ記載する。

---

## 開発サイクル（プロジェクト固有）

このプロジェクトでは **仕様書駆動開発 + テスト駆動開発** を採用する。

```
1. 仕様書を作成・更新（specs/）
       ↓
2. 仕様に基づいてテストを作成・更新
       ↓
3. テストが通るように実装（Red → Green → Refactor）
       ↓
4. 1に戻る
```

### 重要な原則
- **仕様変更 = テスト変更**：仕様を変えたら、まずテストを変える
- **テストが先、実装が後**：テストなしの実装は原則禁止
- **テストに時間をかける**：実装よりテストの設計・実装に注力する
- **カバレッジ100%**：すべてのコードがテストでカバーされている状態を維持

## テストツール（プロジェクト固有）

- ユニット / コンポーネントテスト: Vitest + React Testing Library
- E2Eテスト: Playwright
- カバレッジ計測: Vitest Coverage

## テストファイルの配置（プロジェクト固有）

- 対象ファイルと同じディレクトリに`.test.ts` / `.test.tsx`
- E2Eテストは`e2e/`ディレクトリ

## カバレッジ方針（プロジェクト固有）

- **目標: 100%**
- カバレッジが下がるPRはマージしない
- カバレッジのためだけの無意味なテストは書かない（仕様に基づくテストを書く）

## テストの種類と役割（プロジェクト固有）

### ユニットテスト
- 対象: ユーティリティ関数、カスタムフック
- 目的: 仕様通りの入出力を保証

### コンポーネントテスト
- 対象: UIコンポーネント
- 目的: 仕様通りの表示・動作を保証

### E2Eテスト
- 対象: ユーザーフロー、非同期Server Components
- 目的: 仕様通りのユーザー体験を保証

## テスト名（プロジェクト固有）

- 日本語で具体的に書く
- 仕様書の要件と対応が分かるように書く
- 例: `ユーザー名が空の場合、エラーメッセージを表示する`

## 仕様書とテストの対応（プロジェクト固有）

テストコードには、対応する仕様書の項目をコメントで記載する：

```typescript
describe('ユーザー登録', () => {
  // 仕様: specs/user-registration.md#1.1
  it('メールアドレスが空の場合、エラーを返す', () => {
    // ...
  });
});
```
